<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Cart | ARIILUXE</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.emailjs.com/dist/email.min.js"></script>
</head>
<body class="bg-gray-100 p-6">
  <div class="max-w-3xl mx-auto bg-white p-6 rounded shadow">
    <h1 class="text-2xl font-bold mb-4">Your Cart</h1>
    <ul id="cartItems" class="mb-4"></ul>
    <p id="total" class="text-right font-semibold mb-4"></p>

    <form id="checkoutForm" class="space-y-4">
      <input type="email" id="customer_email" placeholder="Your Email" required class="w-full border p-2 rounded">
      <button type="submit" class="w-full bg-black text-white py-2 rounded hover:bg-gray-800">
        Place Order
      </button>
    </form>
  </div>

  <script>
    // 1. INIT EMAILJS
    window.onload = () => {
    emailjs.init("NiRJLMwt3DdPDK-K7"); // üëà Replace with your public key

    const cart = JSON.parse(localStorage.getItem("cart")) || [];
    const cartList = document.getElementById("cartItems");
    const totalElem = document.getElementById("total");

    let total = 0;
    let summary = "";
    const orderId = "ARIILUXE-" + Date.now();

    cart.forEach(item => {
      const li = document.createElement("li");
      li.className = "flex justify-between border-b py-2";
      li.innerHTML = `<span>${item.name} x${item.qty}</span><span>‚Ç¶${item.price * item.qty}</span>`;
      cartList.appendChild(li);
      summary += `${item.name} x${item.qty} = ‚Ç¶${item.price * item.qty}\n`;
      total += item.price * item.qty;
    });

    totalElem.textContent = `Total: ‚Ç¶${total}`;
    summary += `\nTotal: ‚Ç¶${total}`;

    // 2. SEND ORDER EMAIL
    document.getElementById("checkoutForm").addEventListener("submit", function (e) {
      e.preventDefault();
      const customerEmail = document.getElementById("customer_email").value;

      emailjs.send("service_rlfnynp", "template_d17uidx", {
        order_id: orderId,
        order_summary: summary,
        customer_email: customerEmail
      })
      .then(() => {
        alert("‚úÖ Order placed! You'll receive confirmation shortly.");
        localStorage.removeItem("cart");
        window.location.href = "thank-you.html"; // Optional: redirect
      })
      .catch(error => {
        console.error("EmailJS Error:", error);
        alert("‚ùå Failed to send order. Please try again.");
      });
    });
  </script>
</body>
</html>
